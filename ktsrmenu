#!/system/bin/sh
# KTSR by pedrozzz0 @ GitHub

kts_mode=$(getprop persist.kingtweaks.mode)

if [[ "$kts_mode" == "1" ]]
then
kts_profile=Automatic

elif [[ "$kts_mode" == "2" ]]
then
kts_profile=Battery
        	
elif [[ "$kts_mode" == "3" ]]
then
kts_profile=Balanced
        	
elif [[ "$kts_mode" == "4" ]]
then
kts_profile=Extreme

elif [[ "$kts_mode" == "5" ]]
then
kts_profile=Gaming

else
kts_profile=Unknown
fi

clear
echo ""
echo "**********************************"
echo "* KTSR (Alt.) Profile Controller *"
echo "**********************************"
echo ""
echo "[*] Profile active: $kts_profile"
echo ""
sleep 1.6
echo "[*] Available profiles:"
echo ""
sleep 1.2
echo "[1] Automatic: Change your profile automatically based on specific circumstances and do additional tweaking for a better user-experience."
echo ""
sleep 2
echo "[2] Battery: Reduce power draw to less battery drain and energetic comsumption, ensuring a juicy battery life."
echo ""
sleep 1.5
echo "[3] Balanced: Balanced between battery life and performance, perfect to be used as daily driver."
echo ""
sleep 2
echo "[4] Extreme: Tweaks both CPU / GPU and more for less throttling, maintaining a consistent performance. May drain more battery also. Recommended to benchmarking / heavy apps."
echo ""
sleep 2.5
echo "[5] Gaming: Recommended to gamers who want the best performance possible while playing, with almost zero throttling, tweaks both CPU / GPU and more to achieve it, will probably drain a lot of battery life."
echo ""
sleep 3.5
echo "[6] Optimize apps package"
echo ""
sleep 1.5
echo "[7] Optimize databases"
echo ""
sleep 1.2
echo "[8] Access our telegram channel"
echo ""
sleep 1.8
echo "[9] Access our telegram group"
echo ""
sleep 1.8
PS3="[*] Select the desired option: "
options=("Automatic" "Battery" "Balanced" "Extreme" "Gaming" "Optimize apps" "Optimize databases" "Telegram group" "Exit")
select opt in "${options[@]}"
do
		case $opt in
			"1")
				setprop persist.kingtweaks.mode 1
				;;
				
						"2")
						setprop persist.kingtweaks.mode 2
						;;
						
						"3")
						setprop persist.kingtweaks.mode 3
						;;
						
						"4")
						setprop persist.kingtweaks.mode 4
						;;
						
						"5")
						setprop persist.kingtweaks.mode 5
						;;
						
						"6")
						cmd package bg-dexopt-job
						;;
						
						"7")
						if [[ $(find /system -name "sqlite3" -type f) ]]; then
						echo "[*] Optimizing..."
						for i in $(find /data -iname "*.db"); do
                        sqlite3 "$i" 'VACUUM;'
                        resVac=$?
                        if [[ $resVac == 0 ]]; then
                        resVac="SUCCESS"
                        else
                        resVac="FAILED(ERRCODE)-$resVac"
                        fi
                        sqlite3 "$i" 'REINDEX;'
                        resIndex=$?
                        if [[ $resIndex == 0 ]]; then
                        resIndex="SUCCESS"
                        else
                        resIndex="FAILED(ERRCODE)-$resIndex"
                        fi
                        echo -e "Database $i: VACUUM=$resVac REINDEX=$resIndex" >> /sdcard/KTSR/dbopt.log
                        done
						else
						echo "[!] SQLite not found, aborting..."; exit 1
                        fi
                        ;;
						
						"8")
						am start -a android.intent.action.VIEW -d https://t.me/kingprojectzdiscussion
						;;
						
						"Exit")
						echo "[:)] See ya soon!"; break
						;;
						
						*)
						echo "[!] Unexpected response, aborting..."; sleep 1.2; clear; exit 1
						;;
						esac
done
